# 问题1
-------

手机号的属性标签合并，文件phone.txt有一亿条手机号标签记录，文件new.txt有100万条记录两个文件的手机号合并成一个phone_all.txt文件

例如:
 
phone.txt文件格式如下：  
>13800000000|卡商,诈骗  
>13800000001|诈骗  
>13800000002|卡商  
>13800000003|外卖  


new.txt文件格式：  
>13800000002|卡商,诈骗  
>13800000003|金融  
>13800000004|卡商  

合并之后phone_all.txt文件：  
>13800000000|卡商,诈骗  
>13800000001|诈骗  
>13800000002|卡商,诈骗  
>13800000003|外卖,金融  
>13800000004|卡商  
 
考虑程序性能，内存利用，算法复杂度。

## 字典树方法  (编译软件：codeblock，主函数：main.cpp)
------------------------------------------------------
### 基本思想：  
因为phone.txt文件中的电话号码没有重复的，所以本次只对文件new.txt的11位电话号码构造字典树，然后遍历phone.txt文件进行比较，会出现三种情况：
1. 出现相同的电话号码的话就合并并写入文件phone_all.txt文件中，并在字典树中删除该叶子节点；
2. 在字典树中没有找到电话，则将读到的改行数据直接写入输出文件中；
3. 遍历完phone.txt文件，然后遍历字典树，还存在字典树的数据即为phone.txt文件中没有出现的数据，将其写入输出文件中即可。  
### 所占用的内存空间大小分析：  
因为new.txt文件中的数据量是百万级别的，则设new.txt文件中数据量是N百万，对该文件构造的字典树最多有 （5\*N\*10^6+10^5+10^4+...+10+1）个节点，即是小于6\*N\*10^6的，然后，假设字典树中每个节点所占的空间大小是40个字节，则所占用的内存最多为 (40\*6\*N) M。
### 计算所用的时间分析：
对于字典树，其高度为定值11，插入和查找所用的时间都是常量级别的，所以假设new.txt文件中数据量是N，phone.txt文件的数据量是M，则：  
1. 遍历new.txt文件构造字典树的时间复杂度是O(N)；  
2. 遍历phone.txt文件查找字典树并进行输出文件的写入的时间复杂度是O(M)；  
3. 遍历字典树将剩余的叶子节点写入输出文件的时间复杂度是O(x)，其中x为new.txt出现的而在phone.txt中没有电话号码，这个x是远远小于M，小于等于N；  

**综上所述，算法所用的时间复杂度是O(2N+M)**


### 测试用例：
1. phone.txt文件里面存有1亿个数据，电话号码是13800000000-13899999999，对应的电话号码标签是0-99999999；  
2. new.txt文件中存储了600万个数据，其中300万个电话号码在phone.txt文件中存在，即13800000000-13803000000，对应的标签有所改变，是100-3000099的形式。剩余300万个电话号码在phone.txt文件中不存在，即14800000000-14803000000，对应的标签是0-3000000。 

**运行时间经过测试是470s，所占的内存空间750M。**


## hash_map方法  (编译软件：codeblock，主函数：main_hash_map.cpp)
-----------------------------------------------------------------
### 基本思想：  
同字典树方法类似，只是将存储结构字典树换成了hash_map进行存储，在存储空间上有一定的优化

### 所占的内存空间大小分析：  
hash_map只是对new.txt文件的电话号码以及标签进行了分开存储，电话号码11位，char型字符串，所占空间12个字节，后面标签假设占用20个字节，则hash_map的每个槽所占的空间大小是32字节，假设new.txt文件中有N百万条数据，则所占的空间大小最多为（32\*N）M

### 计算所用的时间分析：
有hash_map的特性可知，其插入和查找的时间复杂度是常量级，因此同字典树时间复杂度是类似的，则设new.txt文件中数据量是N，phone.txt文件的数据量是M，**其算法所用的时间复杂度是O(2N+M)**  

### 测试结果：
同字典树测试用例一样，其测试结果是：**运行时间经过测试是504s，所占的内存空间466M。**

## 注意：  
频繁的写文件操作会浪费程序的执行时间，这里需要采用块写的方式来降低写文件操作所造成的时间浪费的情况。在main_hash_map.cpp文件中，用string型的ssbuffer作为字符缓冲区，当ssbuffer的长度大于1024的时候，将ssbuffer的数据写入文件并清空该缓冲。**程序执行时间可降低至149s。**